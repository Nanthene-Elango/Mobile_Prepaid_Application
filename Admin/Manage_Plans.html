<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="./style.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">

    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/1.13.5/css/jquery.dataTables.min.css" rel="stylesheet">

    <!--charts-->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <link rel="stylesheet" href="./style.css">
    <title>Home</title>
    <style>
        .glass-table {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 10px rgba(255, 255, 255, 0.2);
            padding: 15px;
            overflow: hidden;
        }

        .glass-table th,
        .glass-table td {
            background: rgba(240, 248, 255, 0.485);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: rgb(0,32,96);
            text-align: center;
        }

        .glass-table th {
            font-weight: bold;
            background: rgb(255, 255, 255);
            color: rgb(0,32,96);
        }

        .list-group-item{
            color: rgb(0,32,96);
            border: none;
            transition: transform .5s
        }
        .list-group-item.active,
        .list-group-item:hover{
            background-color: rgb(0,32,96);
            border-radius: 25px;
            color: aliceblue;
        }
        .list-group-item:hover{
            transform: scale(1.045);
        }
        .glass-table tbody tr:hover {
            background: rgba(255, 255, 255, 0.2);
        }
    </style>

</head>

<body style="background-color: rgb(0,32,96);">
    <section class="d-flex justify-content-around" style="height: max-content;">
        <aside class="col-4 col-lg-2 sticky-top" style="color: rgb(0,32,96);height: 800px; background-color: white;" id="sidebar">
            <div class="d-flex flex-column sticky-top">

                <div class="d-flex justify-content-center align-items-center my-4">
                    <!-- Logo -->
                    <a class="navbar-brand" href="./index.html">
                        <img src="./img/Logo_Transparent.png" alt="Logo" style="height: 60px;">
                    </a>
                </div>


                <div class="list-group" id="myList" role="tablist">
                    <div class="d-flex mx-4 my-2 text-center">
                        <a class="list-group-item list-group-item-action active text-decoration-none border-none"
                            id="list-dashboard-list" data-toggle="list" href="#list-dashboard" role="tab"
                            aria-controls="dashboard">
                            <i class="fas fa-line-chart me-1"></i> 
                            Dashboard
                        </a>
                    </div>
                    <div class="d-flex mx-4 my-2 text-center">
                        <a class="list-group-item list-group-item-action text-decoration-none" id="list-plans-list"
                            data-toggle="list" href="#list-plans" role="tab" aria-controls="plans">
                            <i class="fas fa-tools me-1"></i> Manage plans
                        </a>
                    </div>
                    <div class="d-flex mx-4 my-2 text-center">
                        <a class="list-group-item list-group-item-action text-decoration-none "
                            id="list-subscribers-list" data-toggle="list" href="#list-subscribers" role="tab"
                            aria-controls="subscribers">
                            <i class="fas fa-users pt-1 me-1"></i> Subscribers
                        </a>
                    </div>
                    <div class="d-flex mx-4 my-2 text-center">
                        <a class="list-group-item list-group-item-action text-decoration-none " id="list-profile-list"
                            data-toggle="list" href="#list-profile" role="tab" aria-controls="profile">
                            <i class="fas fa-circle-user pt-1 me-1"></i> Manage profile
                        </a>
                    </div>
                </div>

            </div>
        </aside>

        <main class="col-8 col-lg-10" id="main">

            <div class="d-flex justify-content-around sticky-top" style="background-color: rgba(255, 255, 255, 0.368);">

                <button style="border: none; background-color: transparent;" onclick="hideSidebar()" id="hideSideBar">
                    <i class="fa-solid fa-circle-chevron-left text-light fa-2x"></i>
                </button>
                <button class="d-none" style="border: none; background-color: transparent;" onclick="showSidebar()"
                    id="showSideBar">
                    <i class="fa-solid fa-circle-chevron-right text-light fa-2x"></i>
                </button>

                <nav class="navbar navbar-expand navbar-light my-4 d-flex flex-row-reverse bg-white col-11 sticky-top"
                    style="box-shadow: 1px 2px 10px rgb(198, 198, 198); border-radius: 50px;">

                    <li class="nav-item dropdown px-4 list-unstyled" id="accountMenu">
                        <a class="nav-link" href="#" id="accountDropdown" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            <i class="fa fa-user-circle fa-2x" style="color: rgb(0,32,96);"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="./profile">Profile</a></li>
                            <li><a class="dropdown-item text-danger" href="#" onclick="logout()">Logout</a></li>
                        </ul>
                    </li>
                </nav>
            </div>

            <div class="tab-content" id="nav-tabContent">

                <div class="tab-pane fade show active" id="list-dashboard" role="tabpanel"
                    aria-labelledby="list-dashboard-list">
                    <div class="d-flex flex-column flex-lg-row justify-content-around align-items-center my-3">
                        <div class="col-10 col-lg-2 my-3 p-4"
                            style="box-shadow: 1px 2px 10px darkgrey;border-radius: 5px;background-color: white;">
                            <h2>1K</h2>
                            <h6>Active Subscribers</h6>
                        </div>

                        <div class="col-10 col-lg-2 my-3 p-4"
                            style="box-shadow: 1px 2px 10px darkgrey;border-radius: 5px;background-color: white;">
                            <h2>500+</h2>
                            <h6>Active Plan Users</h6>
                        </div>

                        <div class="col-10 col-lg-2 my-3 p-4"
                            style="box-shadow: 1px 2px 10px darkgrey;border-radius: 5px;background-color: white;">
                            <h2>100</h2>
                            <h6>Users Expiry nearing</h6>
                        </div>

                        <div class="col-10 col-lg-2 p-4 my-3"
                            style="box-shadow: 1px 2px 10px darkgrey;border-radius: 5px;background-color: white;">
                            <h2>50</h2>
                            <h6>Plans Available</h6>
                        </div>
                    </div>

                    <div class="d-flex flex-column flex-lg-row justify-content-evenly">
                        <div class="col-5 d-flex justify-content-center p-3"
                            style="box-shadow: 1px 2px 10px darkgrey;border-radius: 5px;background-color: white;height: 250px;">
                            <canvas id="myChart"></canvas>
                        </div>
                        <div class="col-3 p-3 d-flex justify-content-center"
                            style="box-shadow: 1px 2px 10px darkgrey;border-radius: 5px;background-color: white;height: 250px;">
                            <canvas id="myPieChart1"></canvas>
                        </div>
                        <div class="col-3 p-3 d-flex align-items-center"
                            style="box-shadow: 1px 2px 10px darkgrey;border-radius: 5px;background-color: white;height: 250px;">
                            <canvas id="myLineChart"></canvas>
                        </div>
                    </div>

                    <div class="card m-4">
                        <div class="card-header text-white" style="background-color: aliceblue">
                            <h5 class="p-1" style="color: rgb(0,32,96)">Users Nearing Expiry</h5>
                        </div>
                        <div class="card-body">
                            <table id="exampleTable" class="table table-striped table-bordered p-2" style="width:100%">
                                <thead class="table-light">
                                    <tr>
                                        <th>Name</th>
                                        <th>Position</th>
                                        <th>Office</th>
                                        <th>Age</th>
                                        <th>Start Date</th>
                                        <th>Salary</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Tiger Nixon</td>
                                        <td>System Architect</td>
                                        <td>Edinburgh</td>
                                        <td>61</td>
                                        <td>2011/04/25</td>
                                        <td>$320,800</td>
                                    </tr>
                                    <tr>
                                        <td>Garrett Winters</td>
                                        <td>Accountant</td>
                                        <td>Tokyo</td>
                                        <td>63</td>
                                        <td>2011/07/25</td>
                                        <td>$170,750</td>
                                    </tr>
                                    <tr>
                                        <td>Ashton Cox</td>
                                        <td>Junior Technical Author</td>
                                        <td>San Francisco</td>
                                        <td>66</td>
                                        <td>2009/01/12</td>
                                        <td>$86,000</td>
                                    </tr>
                                    <tr>
                                        <td>Cedric Kelly</td>
                                        <td>Senior Javascript Developer</td>
                                        <td>Edinburgh</td>
                                        <td>22</td>
                                        <td>2012/03/29</td>
                                        <td>$433,060</td>
                                    </tr>
                                    <tr>
                                        <td>Airi Satou</td>
                                        <td>Accountant</td>
                                        <td>Tokyo</td>
                                        <td>33</td>
                                        <td>2008/11/28</td>
                                        <td>$162,700</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                </div>

                <div class="tab-pane fade" id="list-plans" role="tabpanel" aria-labelledby="list-plans-list">

                    <div class="container mt-4">
                        <h2 class="text-center text-light">Manage Plans</h2>

                        <!-- Tab Navigation -->
                        <ul class="nav nav-tabs mt-4" id="planTabs">
                            <li class="nav-item">
                                <a class="nav-link active" data-category="All" onclick="filterPlans('All')">All</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-category="Data" onclick="filterPlans('Data')">Data</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-category="Validity"
                                    onclick="filterPlans('Validity')">Validity</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-category="Unlimited"
                                    onclick="filterPlans('Unlimited')">Unlimited</a>
                            </li>
                        </ul>

                        <div class="d-flex justify-content-between">
                            <button class="btn btn-primary m-3" onclick="openAddModal()">Add New Plan</button>

                            <div class="col-3 d-flex m-3">
                                <input type="search" class="form-control " placeholder="Search" aria-label="Search"
                                    aria-describedby="search-addon" style="border-radius: 5px 0px 0px 5px;" />
                                <span class="input-group-text border-0" id="search-addon"
                                    style="border-radius: 0px 5px 5px 0px;">
                                    <i class="fas fa-search"></i>
                                </span>
                            </div>
                        </div>


                        <!-- Table -->
                        <div class="table-container glass-table mb-5">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Category</th>
                                        <th>Data</th>
                                        <th>Validity</th>
                                        <th>Price (Rs)</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="plansTable"></tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Add/Edit Modal -->
                    <div class="modal fade" id="planModal" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="modalTitle">Add Plan</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    <input type="hidden" id="editPlanId">
                                    <div class="mb-3">
                                        <label>Category</label>
                                        <select class="form-control" id="planCategory">
                                            <option>Data</option>
                                            <option>Validity</option>
                                            <option>Unlimited</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label>Data</label>
                                        <input type="text" class="form-control" id="planData">
                                    </div>
                                    <div class="mb-3">
                                        <label>Validity</label>
                                        <input type="text" class="form-control" id="planValidity">
                                    </div>
                                    <div class="mb-3">
                                        <label>Price</label>
                                        <input type="number" class="form-control" id="planPrice">
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary"
                                        data-bs-dismiss="modal">Close</button>
                                    <button type="button" class="btn btn-success" id="savePlanBtn">Save</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="list-subscribers" role="tabpanel"
                    aria-labelledby="list-subscribers-list">
                    Subscribers
                </div>

                <div class="tab-pane fade" id="list-profile" role="tabpanel" aria-labelledby="list-profile-list">
                    Profile
                </div>
            </div>

        </main>
    </section>

    <!-- jQuery and Bootstrap Bundle -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script> -->

    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>

    <script>

        let plansData = [];

        fetch('plans.json')
            .then(response => response.json())
            .then(data => {
                plansData = data.plans;
                displayPlans(plansData);
            });

        function displayPlans(plans) {
            const tableBody = document.getElementById("plansTable");
            tableBody.innerHTML = "";
            plans.forEach((plan, index) => {
                tableBody.innerHTML += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${plan.category}</td>
                        <td>${plan.data}</td>
                        <td>${plan.validity}</td>
                        <td>${plan.price}</td>
                        <td>
                            <span class="action-btn text-primary me-1" style="cursor:pointer" onclick="editPlan(${plan.planid})"><i class="fas fa-edit text-primary"></i> Edit</span>
                            <span class="action-btn text-danger" style="cursor:pointer" onclick="deletePlan(${plan.planid})"><i class="fas fa-trash text-danger"></i> Delete</span>
                        </td>
                    </tr>`;
            });
        }

        function filterPlans(category) {
            document.querySelectorAll(".tab").forEach(tab => tab.classList.remove("active"));
            event.target.classList.add("active");

            if (category === "All") {
                displayPlans(plansData);
            } else {
                const filteredPlans = plansData.filter(plan => plan.category === category);
                displayPlans(filteredPlans);
            }
        }

        function openAddModal() {
            document.getElementById("modalTitle").innerText = "Add Plan";
            document.getElementById("editPlanId").value = "";
            document.getElementById("planCategory").value = "Data";
            document.getElementById("planData").value = "";
            document.getElementById("planValidity").value = "";
            document.getElementById("planPrice").value = "";
            new bootstrap.Modal(document.getElementById("planModal")).show();
        }

        function editPlan(planId) {
            const plan = plansData.find(p => p.planid === planId);
            document.getElementById("modalTitle").innerText = "Edit Plan";
            document.getElementById("editPlanId").value = plan.planid;
            document.getElementById("planCategory").value = plan.category;
            document.getElementById("planData").value = plan.data;
            document.getElementById("planValidity").value = plan.validity;
            document.getElementById("planPrice").value = plan.price;
            new bootstrap.Modal(document.getElementById("planModal")).show();
        }

        document.getElementById("savePlanBtn").addEventListener("click", function () {
            const id = document.getElementById("editPlanId").value;
            const category = document.getElementById("planCategory").value;
            const data = document.getElementById("planData").value;
            const validity = document.getElementById("planValidity").value;
            const price = document.getElementById("planPrice").value;

            if (id) {
                const plan = plansData.find(p => p.planid == id);
                plan.category = category;
                plan.data = data;
                plan.validity = validity;
                plan.price = price;
            } else {
                plansData.push({ planid: plansData.length + 1, category, data, validity, price });
            }
            displayPlans(plansData);
            bootstrap.Modal.getInstance(document.getElementById("planModal")).hide();
        });

        function deletePlan(planId) {
            plansData = plansData.filter(plan => plan.planid !== planId);
            displayPlans(plansData);
        }

        $('#myTab a').on('click', function (e) {
            e.preventDefault()
            $(this).tab('show')
        })

        $('#myList a').on('click', function (e) {
            e.preventDefault()
            $(this).tab('show')
        })

        $(document).ready(function () {
            $('#exampleTable').DataTable();
        });

        const ctx = document.getElementById('myChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May'],
                datasets: [{
                    label: 'Sales',
                    data: [10, 20, 15, 25, 30],
                    backgroundColor: 'rgba(54, 162, 235, 0.5)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true
            }
        });

        const chart = document.getElementById('myPieChart1').getContext('2d');
        new Chart(chart, {
            type: 'pie',
            data: {
                labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple'],
                datasets: [{
                    data: [20, 30, 15, 25, 10],
                    backgroundColor: ['#1E88E5', '#42A5F5', '#64B5F6', '#90CAF9', '#BBDEFB']
                    ,
                }]
            },
            options: {
                responsive: true
            }
        });
        const chart1 = document.getElementById('myLineChart').getContext('2d');
        new Chart(chart1, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    label: 'Sales',
                    data: [10, 25, 15, 40, 30, 50],
                    borderColor: 'blue',
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    borderWidth: 2,
                    fill: true
                }]
            },
            options: {
                responsive: true
            }
        });

        function hideSidebar() {
            document.getElementById("sidebar").classList.add("d-none");
            document.getElementById("main").classList.remove("col-lg-8");
            document.getElementById("main").classList.add("col-lg-12");
            document.getElementById("hideSideBar").classList.add("d-none");
            document.getElementById("showSideBar").classList.remove("d-none");
        }
        function showSidebar() {
            document.getElementById("sidebar").classList.remove("d-none");
            document.getElementById("main").classList.add("col-lg-8");
            document.getElementById("main").classList.remove("col-lg-12");
            document.getElementById("hideSideBar").classList.remove("d-none");
            document.getElementById("showSideBar").classList.add("d-none");
        }
    </script>

</body>

</html>